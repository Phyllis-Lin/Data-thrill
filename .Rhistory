group_by(arrival_date_day_of_month, arrival_date_month, hotel) %>%
count(Count=n())
ggplot(month,
aes(x=arrival_date_day_of_month, y=Count, color=arrival_date_month)) +
geom_line()
#geom_density(alpha = 0.3) +
# facet_wrap(~arrival_date_month, ncol=3)
month <- tidy %>%
group_by(arrival_date_day_of_month, arrival_date_month, hotel) %>%
count(Count=n())
ggplot(month,
aes(x=arrival_date_day_of_month, y=Count, color=arrival_date_month)) +
geom_line() +
theme(axis.text.x = element_text(angle = 90, vjust = 0.5, hjust=1))
#geom_density(alpha = 0.3) +
# facet_wrap(~arrival_date_month, ncol=3)
month <- tidy %>%
group_by(arrival_date_day_of_month, arrival_date_month, hotel) %>%
count(Count=n())
ggplot(month,
aes(x=arrival_date_day_of_month, y=Count, color=arrival_date_month)) +
geom_line() +
theme(axis.text.x = element_text())
#geom_density(alpha = 0.3) +
# facet_wrap(~arrival_date_month, ncol=3)
month <- tidy %>%
group_by(arrival_date_day_of_month, arrival_date_month, hotel) %>%
count(Count=n())
ggplot(month,
aes(x=arrival_date_month, y=Count, fill=hotel)) +
geom_bar(stat = "identity",
position = "dodge") +
theme(axis.text.x = element_text(angle = 90, vjust = 0.5, hjust=1))
knitr::opts_chunk$set(echo = FALSE, cache=TRUE, messages=FALSE, warning=FALSE)
# Make sure you have the latest versions of rmarkdown and bookdown installed
library(ggplot2)
library(tidyverse)
hotels <- read.csv("data/hotels.csv")
year <- hotel %>%
count(arrival_date_month) %>%
ggplot( aes(x = arrival_date_month, y = n)) +
geom_col()
year
month <- tidy %>%
group_by(arrival_date_day_of_month, arrival_date_month, hotel) %>%
count(Count=n())
ggplot(month,
aes(x=arrival_date_month, y=Count, fill=hotel)) +
geom_bar(stat = "identity",
position = "stack") +
theme(axis.text.x = element_text(angle = 90, vjust = 0.5, hjust=1))
month <- tidy %>%
group_by(arrival_date_day_of_month, arrival_date_month, hotel) %>%
count(Count=n())
ggplot(month,
aes(x=arrival_date_month, y=Count, fill=hotel)) +
geom_bar(stat = "identity",
position = "dodge") +
theme(axis.text.x = element_text(angle = 90, vjust = 0.5, hjust=1))
month <- tidy %>%
group_by(arrival_date_day_of_month, arrival_date_month, hotel) %>%
count(Count=n())
ggplot(month,
aes(x=arrival_date_month, y=Count, fill=hotel)) +
geom_bar(stat = "identity",
position = "stack") +
theme(axis.text.x = element_text(angle = 90, vjust = 0.5, hjust=1))
month_countries <- tidy %>%
group_by(arrival_date_month, hotel, Country) %>%
count(Count=n())
View(month_countries)
month_countries <- tidy %>%
group_by(arrival_date_month, hotel, Country) %>%
count(Count=n())
ggplot(month_countries,
aes(x=arrival_date_month, y=Count, fill=hotel)) +
geom_bar(stat = "identity",
position = "stack") +
facet_wrap(~Country)
theme(axis.text.x = element_text(angle = 90, vjust = 0.5, hjust=1))
Top4Country <- tidy %>%
count(Country, sort = T) %>%
head(10)
View(Top4Country)
Top4Country <- tidy %>%
count(Country, sort = T) %>%
head(20)
View(Top4Country)
Top10Country <- tidy %>%
count(Country, sort = T) %>%
head(100) %>%
kable(caption = "Top10 coutries reserved")
library(kableExtra)
Top10Country <- tidy %>%
count(Country, sort = T) %>%
head(100) %>%
kable(caption = "Top10 coutries reserved")
library(kableExtra)
library(dplyr)
Top10Country <- tidy %>%
count(Country, sort = T) %>%
head(100) %>%
kable(caption = "Top10 coutries reserved")
Top10Country <- tidy %>%
count(Country, sort = T) %>%
head(100) %>%
kable(caption = "Top10 coutries reserved")
Top10Country
Top10Country <- tidy %>%
count(Country, sort = T) %>%
head(10) %>%
kable(caption = "Top10 coutries reserved")
Top10Country
month_countries <- tidy %>%
filter(Country %in%c("Portugal", "United Kingdom", "Australia", "China"))
group_by(arrival_date_month, hotel, Country) %>%
count(Count=n())
month_countries <- tidy %>%
filter(Country %in%c("Portugal", "United Kingdom", "Australia", "China")) %>%
group_by(arrival_date_month, hotel, Country) %>%
count(Count=n())
ggplot(month_countries,
aes(x=arrival_date_month, y=Count, fill=hotel)) +
geom_bar(stat = "identity",
position = "stack") +
facet_wrap(~Country)
theme(axis.text.x = element_text(angle = 90, vjust = 0.5, hjust=1))
month_countries <- tidy %>%
filter(Country %in%c("Portugal", "United Kingdom", "Australia", "China")) %>%
group_by(arrival_date_month, hotel, Country) %>%
count(Count=n())
ggplot(month_countries,
aes(x=arrival_date_month, y=Count, fill=hotel)) +
geom_bar(stat = "identity",
position = "stack") +
facet_wrap(~Country, scales = "free_y") +
theme(axis.text.x = element_text(angle = 90, vjust = 0.5, hjust=1))
month_2016 <- tidy %>%
filter(arrival_date_year == 2016) %>%
group_by(arrival_date_day_of_month, arrival_date_month, hotel) %>%
count(Count=n())
ggplot(month,
aes(x=arrival_date_day_of_month, y=Count, color=arrival_date_month)) +
geom_line() +
theme(axis.text.x = element_text())
#geom_density(alpha = 0.3) +
# facet_wrap(~arrival_date_month, ncol=3)
ggplot(month_2016,
aes(x=arrival_date_month, y=Count, fill=hotel)) +
geom_bar(stat = "identity",
position = "stack") +
theme(axis.text.x = element_text(angle = 90, vjust = 0.5, hjust=1))
month_countries <- tidy %>%
filter(arrival_date_year= 2016,
Country %in%c("Portugal", "United Kingdom", "Australia", "China")) %>%
group_by(arrival_date_month, hotel, Country) %>%
count(Count=n())
month_countries <- tidy %>%
filter(arrival_date_year == 2016,
Country %in%c("Portugal", "United Kingdom", "Australia", "China")) %>%
group_by(arrival_date_month, hotel, Country) %>%
count(Count=n())
ggplot(month_countries,
aes(x=arrival_date_month, y=Count, fill=hotel)) +
geom_bar(stat = "identity",
position = "stack") +
facet_wrap(~Country, scales = "free_y") +
theme(axis.text.x = element_text(angle = 90, vjust = 0.5, hjust=1))
week <- tidy %>%
group_by(arrival_date_week_number, hotel) %>%
count(Count=n())
ggplot(week,
aes(x=arrival_date_week_number, y=Count, color=hotel)) +
geom_line() +
theme(axis.text.x = element_text())
ggplot(month_2016,
aes(x=arrival_date_month, y=Count, fill=hotel)) +
geom_bar(stat = "identity",
position = "stack") +
geom_line()
theme(axis.text.x = element_text(angle = 90, vjust = 0.5, hjust=1))
ggplot(month_2016,
aes(x=arrival_date_month, y=Count, fill=hotel)) +
geom_bar(stat = "identity",
position = "stack") +
geom_line() +
theme(axis.text.x = element_text(angle = 90, vjust = 0.5, hjust=1))
ggplot(month_2016,
aes(x=arrival_date_month, y=Count, fill=hotel)) +
geom_bar(stat = "identity",
position = "stack") +
ggplot(week,
aes(x=arrival_date_week_number, y=Count, color=hotel)) +
geom_line() +
theme(axis.text.x = element_text(angle = 90, vjust = 0.5, hjust=1))
ggplot(month_2016,
aes(x=arrival_date_month, y=Count, fill=hotel)) +
geom_bar(stat = "identity",
position = "stack") +
theme(axis.text.x = element_text(angle = 90, vjust = 0.5, hjust=1))
library(ggplotly)
library(plotly)
month_2016 <- tidy %>%
filter(arrival_date_year == 2016) %>%
group_by(arrival_date_day_of_month, arrival_date_month, hotel) %>%
count(Count=n())
ggplotly(month,
aes(x=arrival_date_day_of_month, y=Count, color=arrival_date_month)) +
geom_line() +
theme(axis.text.x = element_text())
library(plotly)
month_2016 <- tidy %>%
filter(arrival_date_year == 2016) %>%
group_by(arrival_date_day_of_month, arrival_date_month, hotel) %>%
count(Count=n())
g1 <- ggplot(month,
aes(x=arrival_date_day_of_month, y=Count, color=arrival_date_month)) +
geom_line() +
theme(axis.text.x = element_text())
ggplotly(g1)
#geom_density(alpha = 0.3) +
# facet_wrap(~arrival_date_month, ncol=3)
library(tidyverse)
library(MASS)
library(broom)
library(kableExtra)
options(digits = 4)
df16 <- read_csv("Documents/ETC5242/lab9/rio_olympics2016.csv")
df16 <- read_csv("/Users/a517/Documents/ETC5242/lab9/rio_olympics2016.csv")
df12 <- read_csv("/Users/a517/Documents/ETC5242/lab9/london_olympics2012.csv")
summary(df16)
summary(df16, digits = 2)
summary(df16, digits = 5)
lognormal_fit ,- fitdistr(df16$Total, "nmoral")
lognormal_fit <- fitdistr(df16$Total, "nmoral")
lognormal_fit <-fitdistr(df16$Total, "nmoral")
df16$logtotal = log(df16$Total)
lognormal_fit <-fitdistr(df16$logotal, "nmoral")
df16$logtotal = log(df16$Total)
df16$logtotal = log(df16$Total)
lognormal_fit <-fitdistr(df16$logtotal, "nmoral")
df16$logtotal = log(df16$Total)
lognormal_fit <-fitdistr(df16$logtotal, "normal")
df16$logtotal = log(df16$Total)
lognormal_fit <-fitdistr(df16$logtotal, "normal")
lognormal_fit
MLE <- lognormal_fit$estimate
month_2016<- factor (month_2016$arrival_date_month,
levels = c("January", "February", "March", "April", "May", "June", "July", "August", "September", "October", "November", "December"))
ggplot(month_2016,
aes(x=arrival_date_month, y=Count, fill=hotel)) +
geom_bar(stat = "identity",
position = "stack") +
theme(axis.text.x = element_text(angle = 90, vjust = 0.5, hjust=1))
month_2016$arrival_date_month <- factor (month_2016$arrival_date_month,
levels = c("January", "February", "March", "April", "May", "June", "July", "August", "September", "October", "November", "December"))
month_2016$arrival_date_month <- factor (month_2016$arrival_date_month,
levels = c("January", "February", "March", "April", "May", "June", "July", "August", "September", "October", "November", "December"))
month_2016 <- tidy %>%
filter(arrival_date_year == 2016) %>%
group_by(arrival_date_day_of_month, arrival_date_month, hotel) %>%
count(Count=n())
month_2016$arrival_date_month <- factor (month_2016$arrival_date_month,
levels = c("January", "February", "March", "April", "May", "June", "July", "August", "September", "October", "November", "December"))
ggplot(month_2016,
aes(x=arrival_date_month, y=Count, fill=hotel)) +
geom_bar(stat = "identity",
position = "stack") +
theme(axis.text.x = element_text(angle = 90, vjust = 0.5, hjust=1))
month_countries <- tidy %>%
filter(arrival_date_year == 2016,
Country %in%c("Portugal", "United Kingdom", "Australia", "China")) %>%
group_by(arrival_date_month, hotel, Country) %>%
count(Count=n())
month_countries$arrival_date_month <- factor (month_countries$arrival_date_month,
levels = c("January", "February", "March", "April", "May", "June", "July", "August", "September", "October", "November", "December"))
ggplot(month_countries,
aes(x=arrival_date_month, y=Count, fill=hotel)) +
geom_bar(stat = "identity",
position = "stack") +
facet_wrap(~Country, scales = "free_y") +
theme(axis.text.x = element_text(angle = 90, vjust = 0.5, hjust=1))
library(plotly)
month_2016 <- tidy %>%
filter(arrival_date_year == 2016) %>%
group_by(arrival_date_day_of_month, arrival_date_month, hotel) %>%
count(Count=n())
g1 <- ggplot(month,
aes(x=arrival_date_day_of_month, y=Count, color=arrival_date_month)) +
geom_line() +
theme(axis.text.x = element_text())
ggplotly(g1)
#geom_density(alpha = 0.3) +
# facet_wrap(~arrival_date_month, ncol=3)
library(plotly)
month_2016 <- tidy %>%
filter(arrival_date_year == 2016) %>%
group_by(arrival_date_day_of_month, arrival_date_month, hotel) %>%
count(Count=n())
g1 <- ggplot(month,
aes(x=arrival_date_day_of_month, y=Count, color=arrival_date_month)) +
geom_col() +
theme(axis.text.x = element_text())
ggplotly(g1)
#geom_density(alpha = 0.3) +
# facet_wrap(~arrival_date_month, ncol=3)
library(plotly)
month_2016 <- tidy %>%
filter(arrival_date_year == 2016) %>%
group_by(arrival_date_day_of_month, arrival_date_month, hotel) %>%
count(Count=n())
month_2016$arrival_date_month <- factor (month_2016$arrival_date_month,
levels = c("January", "February", "March", "April", "May", "June", "July", "August", "September", "October", "November", "December"))
g1 <- ggplot(month,
aes(x=arrival_date_day_of_month, y=Count, color=arrival_date_month)) +
geom_col() +
theme(axis.text.x = element_text())
ggplotly(g1)
#geom_density(alpha = 0.3) +
# facet_wrap(~arrival_date_month, ncol=3)
library(plotly)
month_2016 <- tidy %>%
filter(arrival_date_year == 2016) %>%
group_by(arrival_date_day_of_month, arrival_date_month, hotel) %>%
count(Count=n())
g1 <- ggplot(month,
aes(x=arrival_date_day_of_month, y=Count, color=arrival_date_month, label= Month)) +
xlab("Arrival day") +
geom_col() +
theme(axis.text.x = element_text())
ggplotly(g1)
library(plotly)
month_2016 <- tidy %>%
filter(arrival_date_year == 2016) %>%
group_by(arrival_date_day_of_month, arrival_date_month, hotel) %>%
count(Count=n())
g1 <- ggplot(month,
aes(x=arrival_date_day_of_month, y=Count, color=arrival_date_month)) +
xlab("Arrival day") +
geom_col() +
theme(axis.text.x = element_text())
ggplotly(g1)
#geom_density(alpha = 0.3) +
# facet_wrap(~arrival_date_month, ncol=3)
library(plotly)
month_2016 <- tidy %>%
filter(arrival_date_year == 2016) %>%
group_by(arrival_date_day_of_month, arrival_date_month, hotel) %>%
count(Count=n())
g1 <- ggplot(month,
aes(x=arrival_date_day_of_month, y=Count, color=arrival_date_month, Month=arrival_date_month, label = Month)) +
xlab("Arrival day") +
geom_col() +
theme(axis.text.x = element_text())
ggplotly(g1)
library(plotly)
month_2016 <- tidy %>%
filter(arrival_date_year == 2016) %>%
group_by(arrival_date_day_of_month, arrival_date_month, hotel) %>%
count(Count=n())
g1 <- ggplot(month,
aes(x=arrival_date_day_of_month, y=Count, color=arrival_date_month,label = arrival_date_month)) +
xlab("Arrival day") +
geom_col() +
theme(axis.text.x = element_text())
ggplotly(g1)
#geom_density(alpha = 0.3) +
# facet_wrap(~arrival_date_month, ncol=3)
library(plotly)
month_2016 <- tidy %>%
filter(arrival_date_year == 2016) %>%
group_by(arrival_date_day_of_month, arrival_date_month, hotel) %>%
count(Count=n())
g1 <- ggplot(month,
aes(x=arrival_date_day_of_month, y=Count, color=arrival_date_month, arrival_date_month = Month, label = Month)) +
xlab("Arrival day") +
geom_col() +
theme(axis.text.x = element_text())
ggplotly(g1)
library(plotly)
month_2016 <- tidy %>%
filter(arrival_date_year == 2016) %>%
group_by(arrival_date_day_of_month, arrival_date_month, hotel) %>%
count(Count=n())
g1 <- ggplot(month_2016,
aes(x=arrival_date_day_of_month, y=Count, color=arrival_date_month)) +
xlab("Arrival day") +
geom_col() +
theme(axis.text.x = element_text())
ggplotly(g1)
#geom_density(alpha = 0.3) +
# facet_wrap(~arrival_date_month, ncol=3)
month_2016$arrival_date_month <- factor (month_2016$arrival_date_month,
levels = c("January", "February", "March", "April", "May", "June", "July", "August", "September", "October", "November", "December"))
ggplot(month_2016,
aes(x=arrival_date_month, y=Count, fill=hotel)) +
geom_bar(stat = "identity",
position = "stack") +
xlab("Month") +
theme(axis.text.x = element_text(angle = 90, vjust = 0.5, hjust=1))
month_countries <- tidy %>%
filter(arrival_date_year == 2016,
Country %in%c("Portugal", "United Kingdom", "Australia", "China")) %>%
group_by(arrival_date_month, hotel, Country) %>%
count(Count=n())
month_countries$arrival_date_month <- factor (month_countries$arrival_date_month,
levels = c("January", "February", "March", "April", "May", "June", "July", "August", "September", "October", "November", "December"))
ggplot(month_countries,
aes(x=arrival_date_month, y=Count, fill=hotel)) +
geom_bar(stat = "identity",
position = "stack") +
xlab("Month") +
facet_wrap(~Country, scales = "free_y") +
theme(axis.text.x = element_text(angle = 90, vjust = 0.5, hjust=1))
library(plotly)
month_2016 <- tidy %>%
filter(arrival_date_year == 2016) %>%
group_by(arrival_date_day_of_month, arrival_date_month, hotel) %>%
count(Count=n())
g1 <- ggplot(month_2016,
aes(x=arrival_date_day_of_month, y=Count, color=arrival_date_month)) +
xlab("Arrival day") +
geom_col() +
theme(axis.text.x = element_text()) +
ggplotly(g1)
library(plotly)
month_2016 <- tidy %>%
filter(arrival_date_year == 2016) %>%
group_by(arrival_date_day_of_month, arrival_date_month, hotel) %>%
count(Count=n())
g1 <- ggplot(month_2016,
aes(x=arrival_date_day_of_month, y=Count, color=arrival_date_month)) +
xlab("Arrival day") +
geom_col() +
theme(axis.text.x = element_text()) +
ggplotly(g1)
week <- tidy %>%
group_by(arrival_date_week_number, hotel) %>%
count(Count=n())
ggplot(week,
aes(x=arrival_date_week_number, y=Count, color=hotel)) +
geom_line() +
theme(axis.text.x = element_text())
library(plotly)
month_2016 <- tidy %>%
filter(arrival_date_year == 2016) %>%
group_by(arrival_date_day_of_month, arrival_date_month, hotel) %>%
count(Count=n())
g1 <- ggplot(month_2016,
aes(x=arrival_date_day_of_month, y=Count, color=arrival_date_month)) +
xlab("Arrival day") +
geom_col() +
theme(axis.text.x = element_text()) +
ggplotly(g1)
library(plotly)
month_2016 <- tidy %>%
filter(arrival_date_year == 2016) %>%
group_by(arrival_date_day_of_month, arrival_date_month, hotel) %>%
count(Count=n())
g1 <- ggplot(month_2016,
aes(x=arrival_date_day_of_month, y=Count, color=arrival_date_month)) +
xlab("Arrival day") +
geom_col() +
theme(axis.text.x = element_text())
ggplotly(g1)
#geom_density(alpha = 0.3) +
# facet_wrap(~arrival_date_month, ncol=3)
library(shiny)
library(shiny)
library(shiny)
library(shiny)
library(shiny)
library(shiny)
output$gragh1 <- renderPlotly({
g1 <- ggplot(month_2016,
aes(x=arrival_date_day_of_month, y=Count, color=arrival_date_month)) +
xlab("Arrival day") +
geom_col() +
theme(axis.text.x = element_text())
ggplotly(g1)})
ui <- fluidPage(
selectInput("Country", "What country do you want to look at?",
choices = c("Portugal", "United Kingdom", "Australia", "China"),
selected = "Portugal")
plotlyOutput("gragh1")
)
ui <- fluidPage(
selectInput("Country", "What country do you want to look at?",
choices%in%c("Portugal", "United Kingdom", "Australia", "China"),
selected = "Portugal")
plotlyOutput("gragh1")
)
ui <- fluidPage(
selectInput("Country", "What country do you want to look at?",
choices %in%c("Portugal", "United Kingdom", "Australia", "China"),
selected = "Portugal")
plotlyOutput("gragh1")
)
ui <- fluidPage(
selectInput("Country", "What country do you want to look at?",
choices %in%c("Portugal", "United Kingdom", "Australia", "China"))
plotlyOutput("gragh1")
)
}
output$gragh1 <- renderPlot({
ggplot(month_countries,
aes(x=arrival_date_month, y=Count, fill=hotel)) +
geom_bar(stat = "identity",
position = "stack") +
xlab("Month") +
facet_wrap(~Country, scales = "free_y") +
theme(axis.text.x = element_text(angle = 90, vjust = 0.5, hjust=1))})
